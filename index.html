<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jurnal KAIH - Sekolah Dasar</title>
    
    <!-- 1. Pustaka React & Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 2. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 3. Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        /* Mengunci background utama browser */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: #cbd5e1; /* Warna latar belakang desktop (abu-abu) */
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        /* Container utama yang mensimulasikan layar HP */
        #root {
            width: 100%;
            max-width: 480px; /* Lebar maksimal menyerupai HP */
            background-color: #f8fafc;
            min-height: 100vh;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); /* Bayangan agar timbul */
            position: relative;
            overflow-x: hidden; /* Mencegah geser samping */
        }

        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .animate-fade-in-down { animation: fadeInDown 0.3s ease-out; }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* Custom Scrollbar for list */
        .student-list::-webkit-scrollbar { width: 6px; }
        .student-list::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
    // --- LOGIKA KONFIGURASI FIREBASE ---
        let firebaseConfig = null;
        let isConfigValid = false;

        // Cek apakah ada config global dari environment
        if (typeof __firebase_config !== 'undefined') {
            try {
                firebaseConfig = JSON.parse(__firebase_config);
                isConfigValid = true;
            } catch (e) {
                console.error("Gagal parsing auto-config", e);
            }
        }

        // Fallback Config (Gunakan Project Anda sendiri jika global tidak ada)
        if (!isConfigValid) {
            firebaseConfig = {
                // GANTI DENGAN CONFIG FIREBASE ANDA
                apiKey: "AIzaSyBPyQ7VvSnumxYWm3-TL8t_3qru15eX7fA", 
                authDomain: "jurnal-smpn7-dedai.firebaseapp.com",
                projectId: "jurnal-smpn7-dedai",
                storageBucket: "jurnal-smpn7-dedai.firebasestorage.app",
                messagingSenderId: "342279014464",
                appId: "1:342279014464:web:51209b7c49675b2715b7a5"
            };
            
            // Validasi sederhana
            if (firebaseConfig.apiKey && !firebaseConfig.apiKey.includes("GANTI_DENGAN")) {
                isConfigValid = true;
            }
        }

        let auth, db;
        // Gunakan variable __app_id jika tersedia untuk memastikan path Firestore sesuai rules
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'jurnal-kaih-sd';
        
        // --- URL GOOGLE SHEET (Opsional) ---
        // Ganti dengan URL Web App Google Apps Script Anda jika ingin ekspor ke Excel
        const GOOGLE_SHEET_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzgvE1eTu6Lpqd5zRhsib_-lP8SMKPkepRJGzLaP_6vBnFMAmusXFrNe0CcqAt-1Bnx/exec"; 

        if (isConfigValid) {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            auth = firebase.auth();
            db = firebase.firestore();
        }

    // --- DATA GURU (DARI INPUT USER) ---
        const TEACHERS = [
            { id: 't_3A', name: 'ROFIQOTUNNUZUL,S.T', username: 'Rofiqotunnuzul', password: 'Absen@2026', classId: '3A' },
            { id: 't_1A', name: 'NURJANAH, S.Pd SD', username: 'Nurjanah', password: 'Absen@2026', classId: '1A' },
            { id: 't_1B', name: 'RITA ROSITA,S.Pd', username: 'Rita Rosita', password: 'Absen@2026', classId: '1B' },
            { id: 't_2B', name: 'RETNO SANDININGRUM, S.Pd.SD', username: 'Retno Sandiningrun', password: 'Absen@2026', classId: '2B' },
            { id: 't_5A', name: 'CAHYANING WULANDARI, S.Pd', username: 'Cahyaning Wulandari', password: 'Absen@2026', classId: '5A' },
            { id: 't_6B', name: 'ISMI AYU ANISA, S.Pd', username: 'Ismi Ayu Anisa', password: 'Absen@2026', classId: '6B' },
            { id: 't_4A', name: 'USWATUL HASANAH,S.Pd.SD', username: 'Uswatul Hasanah', password: 'Absen@2026', classId: '4A' },
            { id: 't_1C', name: 'MIFTA IRENE NABILA, S.Pd', username: 'Mifta Irene Nabila', password: 'Absen@2026', classId: '1C' },
            { id: 't_4B', name: 'KARTIKA SARI ROMADHANI,S.Pd', username: 'Kartika Sari Romadhani', password: 'Absen@2026', classId: '4B' },
            { id: 't_6A', name: 'SILVI DAVISKA,S.Pd', username: 'Silvi Daviska', password: 'Absen@2026', classId: '6A' },
            { id: 't_2A', name: 'RATIH PRABAWATI,S.Pd', username: 'Ratih Prabawati', password: 'Absen@2026', classId: '2A' },
            { id: 't_5B', name: 'ELLA PURNAMASARI, S.Pd', username: 'Ella Purnamasari', password: 'Absen@2026', classId: '5B' },
            { id: 't_3C', name: 'MALIKAH NURUL AZIZAH, S.Pd', username: 'Malikah Nurul Azizah', password: 'Absen@2026', classId: '3C' },
            { id: 't_3B', name: 'HANA NAQIYYA NADA, S.Pd', username: 'Hana Naqiyya Nada', password: 'Absen@2026', classId: '3B' }
        ];

    // --- DATA SISWA (DARI INPUT USER) ---
        const ALL_STUDENTS = [
            // KELAS 1A
            { id: 's_1A_1', name: 'ADEEVA AFSHEEN RADITYA', classId: '1A' },
            { id: 's_1A_2', name: 'AJENG KIRANA AN-NAFI PRAMESTI', classId: '1A' },
            { id: 's_1A_3', name: 'AKHMAD IBNU AZZAM RAMADHAN', classId: '1A' },
            { id: 's_1A_4', name: 'ATHA PRADIPTA HADID', classId: '1A' },
            { id: 's_1A_5', name: 'ATHAFARIZ NAUFAL RUMI', classId: '1A' },
            { id: 's_1A_6', name: 'AYLA SYAFWANTI RAMADANI', classId: '1A' },
            { id: 's_1A_7', name: 'AZHALEA LEMBAYUNG SENJA', classId: '1A' },
            { id: 's_1A_8', name: 'BRILLIANT NEYSA RAMADANI', classId: '1A' },
            { id: 's_1A_9', name: 'CARRISA AQILA PUTRI', classId: '1A' },
            { id: 's_1A_10', name: 'CHIKA NABILA PAMUNGKAS', classId: '1A' },
            { id: 's_1A_11', name: 'DELISHA ZIA ALMAHYRA', classId: '1A' },
            { id: 's_1A_12', name: 'ERLANGGA ARYA BAKTI', classId: '1A' },
            { id: 's_1A_13', name: 'FADHIL SUDIBJO', classId: '1A' },
            { id: 's_1A_14', name: 'HABIL RIGAN ARZANI', classId: '1A' },
            { id: 's_1A_15', name: 'HENDRA SYAHPUTRA', classId: '1A' },
            { id: 's_1A_16', name: 'MISHALL ARSYAKAYLA PAMUNGKAS', classId: '1A' },
            { id: 's_1A_17', name: 'MOKHAMMAD FAHRI PRATAMA WIBOWO', classId: '1A' },
            { id: 's_1A_18', name: 'NADYA PUTRI NUR RAMADHANI', classId: '1A' },
            { id: 's_1A_19', name: 'PIJAR JENAKA PRIYAMBODO', classId: '1A' },
            { id: 's_1A_20', name: 'REYNANDRA RIZKY ABIMANYU', classId: '1A' },
            { id: 's_1A_21', name: 'SEKALA PIJAR NARESWARA', classId: '1A' },
            { id: 's_1A_22', name: 'ZHAFIER AL ZAYDAN PRAYUGO', classId: '1A' },
            { id: 's_1A_23', name: 'ZHELLINE AYUNINDYA PERTIWI', classId: '1A' },
            { id: 's_1A_24', name: 'ZIVANA AYUNINA PUTRI', classId: '1A' },
            // KELAS 1B
            { id: 's_1B_1', name: 'AHMAD GILANG SANTOSA', classId: '1B' },
            { id: 's_1B_2', name: 'AHNAF FATIH AL ATHAR BIANTOKO', classId: '1B' },
            { id: 's_1B_3', name: 'AL FARIEL KHALFI BATRISKY', classId: '1B' },
            { id: 's_1B_4', name: 'ALBARRA AFRYO ENDRASUTA', classId: '1B' },
            { id: 's_1B_5', name: 'ALEEYA SHAFEEA KHAIRA', classId: '1B' },
            { id: 's_1B_6', name: 'ANANDA CAMILA PRAMUDITA', classId: '1B' },
            { id: 's_1B_7', name: 'ANISA HILYA AYUNINDIYA', classId: '1B' },
            { id: 's_1B_8', name: 'ATHAR MAUZA', classId: '1B' },
            { id: 's_1B_9', name: 'AZZAHRA AN NAILAH MAHREEN', classId: '1B' },
            { id: 's_1B_10', name: 'AZZAHRA DAVINA', classId: '1B' },
            { id: 's_1B_11', name: 'FATIMAH AZ ZAHRA', classId: '1B' },
            { id: 's_1B_12', name: 'GIO RAMDAN ADIANSYAH', classId: '1B' },
            { id: 's_1B_13', name: 'HASNA ABIDAH IZZIHNI', classId: '1B' },
            { id: 's_1B_14', name: 'KAMILA AZKADINA ABDILLAH', classId: '1B' },
            { id: 's_1B_15', name: 'KANTATA SAGA JOYONEGORO', classId: '1B' },
            { id: 's_1B_16', name: 'KHALIQA PUTRI AZZAHRA', classId: '1B' },
            { id: 's_1B_17', name: 'MUHAMMAD ABIYOGA AKBAR SETYAWAN', classId: '1B' },
            { id: 's_1B_18', name: 'MUHAMMAD ZIDAN AQSA DIARTA', classId: '1B' },
            { id: 's_1B_19', name: 'NATHASYA AVRILIANA', classId: '1B' },
            { id: 's_1B_20', name: 'NAYLA SYIFA ALMUIZ', classId: '1B' },
            { id: 's_1B_21', name: 'QALESYA AFSHEEN MYESHA FACHRUDDIN', classId: '1B' },
            { id: 's_1B_22', name: 'RAFFASYA RADEYA MAHARDIKA', classId: '1B' },
            { id: 's_1B_23', name: 'RYOTA ABQORY SANTOSO', classId: '1B' },
            { id: 's_1B_24', name: 'SATRIA BARRA ERSYA', classId: '1B' },
            // KELAS 1C
            { id: 's_1C_1', name: 'AFIFAH NASYATUL AULIA', classId: '1C' },
            { id: 's_1C_2', name: 'ALTHAF RIFQIE ABRISAM', classId: '1C' },
            { id: 's_1C_3', name: 'ARSAKHA VIRENDRA SHAFWAN', classId: '1C' },
            { id: 's_1C_4', name: 'ARSINTA KANAYA PUTRI', classId: '1C' },
            { id: 's_1C_5', name: 'BREA AZKAYRA JOZA WIRAYU', classId: '1C' },
            { id: 's_1C_6', name: 'CISSY SHANUM ATTAYA', classId: '1C' },
            { id: 's_1C_7', name: 'CLAIRINE ALISHA PUTRI', classId: '1C' },
            { id: 's_1C_8', name: 'DAFFA GHOZZAL MUWAFFAQ', classId: '1C' },
            { id: 's_1C_9', name: 'GABRIELLA AULIA FARAH', classId: '1C' },
            { id: 's_1C_10', name: 'HASNA ARUM NADHIFAH', classId: '1C' },
            { id: 's_1C_11', name: 'IBRAHIM KENZIE ALFARIZQI', classId: '1C' },
            { id: 's_1C_12', name: 'MUHAMAD REZA AGUNG PRATAMA', classId: '1C' },
            { id: 's_1C_13', name: 'MUHAMMAD ARSENIO AL HADI', classId: '1C' },
            { id: 's_1C_14', name: 'MUHAMMAD AWFA IBRAHIM', classId: '1C' },
            { id: 's_1C_15', name: 'MUHAMMAD RYUGA DARREL ATHAYA', classId: '1C' },
            { id: 's_1C_16', name: 'MUHAMMAD ZIAN ALFARIZI', classId: '1C' },
            { id: 's_1C_17', name: 'NAURA AQILA RAMADHANIA', classId: '1C' },
            { id: 's_1C_18', name: 'NURUSYAM RISKIAMRAN', classId: '1C' },
            { id: 's_1C_19', name: 'RICKY NURDIANSYAH', classId: '1C' },
            { id: 's_1C_20', name: 'RISTI NURRAISA KAYRA', classId: '1C' },
            { id: 's_1C_21', name: 'SAFIRA KHAIRA LUBNA', classId: '1C' },
            { id: 's_1C_22', name: 'SASTRA RIATMADJA', classId: '1C' },
            { id: 's_1C_23', name: 'SAVINA AULIA PUTRI', classId: '1C' },
            { id: 's_1C_24', name: 'SHARGA AZWAR RABBANI', classId: '1C' },
            // KELAS 2A
            { id: 's_2A_1', name: 'ABIDZAR ASKA ARACHEL', classId: '2A' },
            { id: 's_2A_2', name: 'ABIMANYU PUTRA WIDIYANTO', classId: '2A' },
            { id: 's_2A_3', name: 'ACHMAD ALFA RIZKI', classId: '2A' },
            { id: 's_2A_4', name: 'ADARA ELEANORA RAHMAWATI', classId: '2A' },
            { id: 's_2A_5', name: 'AFIFAH KHANSA HANIFA', classId: '2A' },
            { id: 's_2A_6', name: 'AISHA AZZAHRA AL GHIFFARI', classId: '2A' },
            { id: 's_2A_7', name: 'AISHA AZZURA AL GHIFFARI', classId: '2A' },
            { id: 's_2A_8', name: 'AKIO MANDANI FATHAAN', classId: '2A' },
            { id: 's_2A_9', name: 'ANYUWA ASHALINA NALADHIFA', classId: '2A' },
            { id: 's_2A_10', name: 'ARDHAN DZAKY RABBANI', classId: '2A' },
            { id: 's_2A_11', name: 'ARGATSANI DAMAR BAKTI', classId: '2A' },
            { id: 's_2A_12', name: 'ARYA ILHAM PRASETYA', classId: '2A' },
            { id: 's_2A_13', name: 'AZZAM RAYSHIVA NABIL ALZHAFIR', classId: '2A' },
            { id: 's_2A_14', name: 'BINTANG YULIAN VARELIO', classId: '2A' },
            { id: 's_2A_15', name: 'DINARA MEILAN ARTAFATMA', classId: '2A' },
            { id: 's_2A_16', name: 'DIRGA ADITAMA JANUARTA', classId: '2A' },
            { id: 's_2A_17', name: 'FIONA AZZAHRA NAUVALYN', classId: '2A' },
            { id: 's_2A_18', name: 'GIEGIE RAFANDA', classId: '2A' },
            { id: 's_2A_19', name: 'HELENA FRILYA SYAQUILA', classId: '2A' },
            { id: 's_2A_20', name: 'INDRA LAKSMANA PUTRA', classId: '2A' },
            { id: 's_2A_21', name: 'JIHAN ATHIYA MAKAILAH FAKHIRAH', classId: '2A' },
            { id: 's_2A_22', name: 'JOSEVARO ATHARIS CHALIEF', classId: '2A' },
            { id: 's_2A_23', name: 'KANAYA KIAN DAHAYU', classId: '2A' },
            { id: 's_2A_24', name: 'KAYLA HANANIA AKLEEMA RAMADHANI', classId: '2A' },
            { id: 's_2A_25', name: 'M. HANIF AL RASYID', classId: '2A' },
            { id: 's_2A_26', name: 'MAHIRA HANA AZWA ZAKIYA', classId: '2A' },
            { id: 's_2A_27', name: 'MOCHAMMAD BAGAS KHOIRUDDIN', classId: '2A' },
            { id: 's_2A_28', name: 'MUHAMMAD ABIMANYU ATHARRAZKA', classId: '2A' },
            { id: 's_2A_29', name: 'MUHAMMAD RAFASYA FAUZAN', classId: '2A' },
            { id: 's_2A_30', name: 'MUHAMMAD ZAFRAN GHANI ELFARO', classId: '2A' },
            { id: 's_2A_31', name: 'NAYLA SYAHMINA ARIFIN', classId: '2A' },
            { id: 's_2A_32', name: 'NIANA PUTRI SYAQUINTA', classId: '2A' },
            { id: 's_2A_33', name: 'RAFISKI ALBI DAVIE', classId: '2A' },
            { id: 's_2A_34', name: 'SYAHM ADHIASTA AL-GHIFARI', classId: '2A' },
            // KELAS 2B
            { id: 's_2B_1', name: 'ABIYASA YUSUF', classId: '2B' },
            { id: 's_2B_2', name: 'AFZAM FARIS HARIYANTO', classId: '2B' },
            { id: 's_2B_3', name: 'ALESHA SALSABILA MUFIJAR', classId: '2B' },
            { id: 's_2B_4', name: 'ALTHAF RIFQIE ABRIZAM', classId: '2B' },
            { id: 's_2B_5', name: 'ANEIRA SABRIA CLARASATI', classId: '2B' },
            { id: 's_2B_6', name: 'ANINDITA FIRMANSYAH PUTRI', classId: '2B' },
            { id: 's_2B_7', name: 'ARSYFA NABILA WARDANI', classId: '2B' },
            { id: 's_2B_8', name: 'AZIZAH NAYYRA RAMADHANI', classId: '2B' },
            { id: 's_2B_9', name: 'CARISSA RAHMA AURELIA', classId: '2B' },
            { id: 's_2B_10', name: 'CLEOPATRA DEWANTI', classId: '2B' },
            { id: 's_2B_11', name: 'DANUJA RAHAGI ARKANA', classId: '2B' },
            { id: 's_2B_12', name: 'ERIKA DEVI QUEENSHA', classId: '2B' },
            { id: 's_2B_13', name: 'FAHREZA ZHAFRAN ABRISAM', classId: '2B' },
            { id: 's_2B_14', name: 'FAIHA LATISHA INARA', classId: '2B' },
            { id: 's_2B_15', name: 'FALISHA QAISARA', classId: '2B' },
            { id: 's_2B_16', name: 'FARHAN ALFARIZI SYAHPUTRA', classId: '2B' },
            { id: 's_2B_17', name: 'HANIF AZMI AUNILLAH', classId: '2B' },
            { id: 's_2B_18', name: 'M. ASAD MALIK SA\'DUDIN', classId: '2B' },
            { id: 's_2B_19', name: 'MOCHAMAD SHARGA ARTHANABIL SETIAWAN', classId: '2B' },
            { id: 's_2B_20', name: 'MOKHAMAD ARSYAD SAPUTRA', classId: '2B' },
            { id: 's_2B_21', name: 'MUHAMAD HAFIZH PUTRA EDI', classId: '2B' },
            { id: 's_2B_22', name: 'MUHAMMAD AKMAL RAHANDIKA', classId: '2B' },
            { id: 's_2B_23', name: 'MUHAMMAD ALVARENDRA PRATAMA', classId: '2B' },
            { id: 's_2B_24', name: 'MUHAMMAD RIZKI ALFARIZI', classId: '2B' },
            { id: 's_2B_25', name: 'NARAYA KAYLA FITRI', classId: '2B' },
            { id: 's_2B_26', name: 'NATASYA SHIDQIYA AURORA', classId: '2B' },
            { id: 's_2B_27', name: 'RAJENDRA ARZENIO ARIFIN', classId: '2B' },
            { id: 's_2B_28', name: 'REGITA RUSLIANA', classId: '2B' },
            { id: 's_2B_29', name: 'SADEWA RAKASENA WISNU PRATAMA', classId: '2B' },
            { id: 's_2B_30', name: 'SATRIA ARIF WIRA YUDHA', classId: '2B' },
            { id: 's_2B_31', name: 'SEAN ABIMANYU WIRATAMA HUSNADI', classId: '2B' },
            { id: 's_2B_32', name: 'SYIFA\' FAHRI ROMADLON', classId: '2B' },
            { id: 's_2B_33', name: 'VERO JUANITA RAMADHANI', classId: '2B' },
            // KELAS 3A
            { id: 's_3A_1', name: 'ADELIA KIRANA JUNAEDI', classId: '3A' },
            { id: 's_3A_2', name: 'ADITYA HAMIZAN ABDULLAH', classId: '3A' },
            { id: 's_3A_3', name: 'AHMAD ARDA IZZUL HAQIQI', classId: '3A' },
            { id: 's_3A_4', name: 'AKHMAD BISMABRAMASTA RAKASIWI', classId: '3A' },
            { id: 's_3A_5', name: 'ALIF ARDIANSYAH WIJAYA', classId: '3A' },
            { id: 's_3A_6', name: 'ALIFIA NAZIFA', classId: '3A' },
            { id: 's_3A_7', name: 'ANDY SURYA SAPUTRA', classId: '3A' },
            { id: 's_3A_8', name: 'ARSYILA DAMA SINGHARAHMI', classId: '3A' },
            { id: 's_3A_9', name: 'BERLIAN NADA WIJAYANTI', classId: '3A' },
            { id: 's_3A_10', name: 'ELSA PUTRI PERMADHANI', classId: '3A' },
            { id: 's_3A_11', name: 'GIBRAN AL SHEHABI', classId: '3A' },
            { id: 's_3A_12', name: 'HAFSY HAFIZUAN RAFANZA', classId: '3A' },
            { id: 's_3A_13', name: 'KALISTA INARA PUTRI', classId: '3A' },
            { id: 's_3A_14', name: 'MAHIRA CANTIKA HANANIA', classId: '3A' },
            { id: 's_3A_15', name: 'MUHAMMAD ASSYRAAF ABDILLAH', classId: '3A' },
            { id: 's_3A_16', name: 'MUHAMMAD FAKHRIS ILHAM', classId: '3A' },
            { id: 's_3A_17', name: 'MUHAMMAD IBRAHIM AFFANDI', classId: '3A' },
            { id: 's_3A_18', name: 'NABIL AZMI RAMADHAN', classId: '3A' },
            { id: 's_3A_19', name: 'NICKYTA PUTRI PERMATA SARI', classId: '3A' },
            { id: 's_3A_20', name: 'NUR AHMAD ALFIANSYAH', classId: '3A' },
            { id: 's_3A_21', name: 'RAIHAN DIRAJA PRIADIKA', classId: '3A' },
            { id: 's_3A_22', name: 'REI FAHMI VEGA ERLANGGA', classId: '3A' },
            { id: 's_3A_23', name: 'TAHLITA ARSILIA BILQIS', classId: '3A' },
            // KELAS 3B
            { id: 's_3B_1', name: 'AFIFAH ZIYA MAKKAILAH', classId: '3B' },
            { id: 's_3B_2', name: 'AISYAH KANAHAYA HADI', classId: '3B' },
            { id: 's_3B_3', name: 'ALINA EKA AZAHRA', classId: '3B' },
            { id: 's_3B_4', name: 'ARJUN LIDRA SAPUTRO', classId: '3B' },
            { id: 's_3B_5', name: 'AUFFA RAYA RAFHANY', classId: '3B' },
            { id: 's_3B_6', name: 'AYRA BITTA SHAFANA', classId: '3B' },
            { id: 's_3B_7', name: 'AZREEN SAIDATUL NAFISSA', classId: '3B' },
            { id: 's_3B_8', name: 'CAHAYA ELYSIA RAMADHANI', classId: '3B' },
            { id: 's_3B_9', name: 'ERZHA FITRI NUR SUWANDI', classId: '3B' },
            { id: 's_3B_10', name: 'FARIS AKHMAD ABDILLAH', classId: '3B' },
            { id: 's_3B_11', name: 'JOA AZALEA ARUMI WIDODO', classId: '3B' },
            { id: 's_3B_12', name: 'KHAIRA RIZANA PERMATA FAUZY', classId: '3B' },
            { id: 's_3B_13', name: 'M.ABIZAR ASHAR', classId: '3B' },
            { id: 's_3B_14', name: 'MARYAM SYIFA NUR AZIZAH', classId: '3B' },
            { id: 's_3B_15', name: 'MUHAMMAD AFKAR FAUZAL KABIR', classId: '3B' },
            { id: 's_3B_16', name: 'MUHAMMAD ATHAR SYARIFUDDIN', classId: '3B' },
            { id: 's_3B_17', name: 'MUHAMMAD HANNAN RASYID AL-GHIFARI', classId: '3B' },
            { id: 's_3B_18', name: 'MUHAMMAD MUFLIH', classId: '3B' },
            { id: 's_3B_19', name: 'PRAM SATHYA JOAN SACHDEV DILLON', classId: '3B' },
            { id: 's_3B_20', name: 'RAMA AJI PAMUNGKAS', classId: '3B' },
            { id: 's_3B_21', name: 'SAFIRA', classId: '3B' },
            { id: 's_3B_22', name: 'SHANAYA PHILIA AMADEA', classId: '3B' },
            { id: 's_3B_23', name: 'ULUL AZMI', classId: '3B' },
            // KELAS 3C
            { id: 's_3C_1', name: 'ALHAM RAFFANZA YOGA WICAKSANA', classId: '3C' },
            { id: 's_3C_2', name: 'ALUNA PUTRI KARENINA', classId: '3C' },
            { id: 's_3C_3', name: 'AMIRA CEISYA QEENARA', classId: '3C' },
            { id: 's_3C_4', name: 'ARETHA KHAIRA AZZAHRA', classId: '3C' },
            { id: 's_3C_5', name: 'AULIA AZKADYNA', classId: '3C' },
            { id: 's_3C_6', name: 'AURELYA DZAKIYAH PUTRI', classId: '3C' },
            { id: 's_3C_7', name: 'AZKA ALDRIC SYAHPUTRA', classId: '3C' },
            { id: 's_3C_8', name: 'BENNY KURNIAWAN', classId: '3C' },
            { id: 's_3C_9', name: 'BILLAL AL HABIBI', classId: '3C' },
            { id: 's_3C_10', name: 'DAVIRA LAQUITTA WIDIANI', classId: '3C' },
            { id: 's_3C_11', name: 'ELLENA ADARA SALSABILA PRIBADI', classId: '3C' },
            { id: 's_3C_12', name: 'FAREL DWI ANDIKA', classId: '3C' },
            { id: 's_3C_13', name: 'FITRIA CANDRA KARTIKA', classId: '3C' },
            { id: 's_3C_14', name: 'JODIDA KHUMAIRA NIKMATUSSHOLIHA', classId: '3C' },
            { id: 's_3C_15', name: 'MOCHAMMAD ALBIRRU BAYANAKA ANGGORO', classId: '3C' },
            { id: 's_3C_16', name: 'MUHAMMAD ATHALLAH NINO AKBAR', classId: '3C' },
            { id: 's_3C_17', name: 'MUHAMMAD FARHAN ARIZKY', classId: '3C' },
            { id: 's_3C_18', name: 'MUHAMMAD ZAKY ALFARIZ', classId: '3C' },
            { id: 's_3C_19', name: 'NURULAIL RISKIANANDA', classId: '3C' },
            { id: 's_3C_20', name: 'RAFFASYA SADA ALYA', classId: '3C' },
            { id: 's_3C_21', name: 'RALLIN SYAHIRAH MAULIDINA', classId: '3C' },
            { id: 's_3C_22', name: 'RIANG MADA AGURE', classId: '3C' },
            { id: 's_3C_23', name: 'ROSSA SIKOTI WAHYUDIANTO PUTRI', classId: '3C' },
            { id: 's_3C_24', name: 'SYAFA DWI AQILA', classId: '3C' },
            { id: 's_3C_25', name: 'VIO KENJI PASENA', classId: '3C' },
            { id: 's_3C_26', name: 'ZIDDAN MAULANA IKHSAN', classId: '3C' },
            // KELAS 4A
            { id: 's_4A_1', name: 'ALBIANSYAH BARRA PAHLEVI', classId: '4A' },
            { id: 's_4A_2', name: 'ALYA FIRDA SALSABILA', classId: '4A' },
            { id: 's_4A_3', name: 'ARYA ZAKI PUTRANTO', classId: '4A' },
            { id: 's_4A_4', name: 'BHREAMITA GENDIS NARESWARI', classId: '4A' },
            { id: 's_4A_5', name: 'BRIAN HAIDAR AUGASTA', classId: '4A' },
            { id: 's_4A_6', name: 'CAHYO ALDRICO', classId: '4A' },
            { id: 's_4A_7', name: 'CHLEYNATA DARLA MACELLA', classId: '4A' },
            { id: 's_4A_8', name: 'DAVIS MARSAL PASMAWAN', classId: '4A' },
            { id: 's_4A_9', name: 'DHANIA CHAERUNISA MILANI', classId: '4A' },
            { id: 's_4A_10', name: 'EREN NABILA', classId: '4A' },
            { id: 's_4A_11', name: 'FRIZKY RAFAEYZA RACHMAN', classId: '4A' },
            { id: 's_4A_12', name: 'HAIFA SABRINA QISYA WAHONO', classId: '4A' },
            { id: 's_4A_13', name: 'KAYONA ANEZKA AYUNINDYA', classId: '4A' },
            { id: 's_4A_14', name: 'LAURA BAVILIA', classId: '4A' },
            { id: 's_4A_15', name: 'MUHAMMAD RIZKI ALFARIZI', classId: '4A' },
            { id: 's_4A_16', name: 'QUIRA SIMRA RAMADHANISA VAN KHALISA', classId: '4A' },
            { id: 's_4A_17', name: 'RISKY CAHYO RAMADAN', classId: '4A' },
            { id: 's_4A_18', name: 'USMAN MAULANA', classId: '4A' },
            { id: 's_4A_19', name: 'VIOLETA RAFANIA', classId: '4A' },
            { id: 's_4A_20', name: 'WISULTHAN NARENDRA KRISV', classId: '4A' },
            { id: 's_4A_21', name: 'ZHAFRAN EL YAZDAN PRAYUGO', classId: '4A' },
            { id: 's_4A_22', name: 'ZIVOLEA VALERIE KHALILUNA', classId: '4A' },
            // KELAS 4B
            { id: 's_4B_1', name: 'ABDILLAH HAKIM', classId: '4B' },
            { id: 's_4B_2', name: 'ACHMAD ARI ROMADHON', classId: '4B' },
            { id: 's_4B_3', name: 'AFNAN ATMA PURNAMA', classId: '4B' },
            { id: 's_4B_4', name: 'AHMAD DAMAR PRAYOGI', classId: '4B' },
            { id: 's_4B_5', name: 'ALMIRA AFSHEEN SINGHAMURTI', classId: '4B' },
            { id: 's_4B_6', name: 'ANAQIE MIRZA PUTRA AJI', classId: '4B' },
            { id: 's_4B_7', name: 'ANINDITA KEISA ZAHRA ILHAM', classId: '4B' },
            { id: 's_4B_8', name: 'ANINDITA KEISHA AZZAHRA', classId: '4B' },
            { id: 's_4B_9', name: 'ARDHANSYAH WIJAYA', classId: '4B' },
            { id: 's_4B_10', name: 'ATTAKILA KENAR UBHAYAHITA', classId: '4B' },
            { id: 's_4B_11', name: 'AZKAYRA GHAITSA SOFYANTO', classId: '4B' },
            { id: 's_4B_12', name: 'BELLA GRACEVA AMANDA PUTRI', classId: '4B' },
            { id: 's_4B_13', name: 'EKA DESTA WAHYU PRASETYO', classId: '4B' },
            { id: 's_4B_14', name: 'ELITA BINTANG PRASETIO', classId: '4B' },
            { id: 's_4B_15', name: 'FARREL SILVIO KUSTIAWAN', classId: '4B' },
            { id: 's_4B_16', name: 'FATHIMATUZ ZAHRA', classId: '4B' },
            { id: 's_4B_17', name: 'GHANI AS SAKHA', classId: '4B' },
            { id: 's_4B_18', name: 'KEISHA ANINDITA ZAHRA', classId: '4B' },
            { id: 's_4B_19', name: 'MUHAMMAD AGAM RAJASYAH', classId: '4B' },
            { id: 's_4B_20', name: 'MUHAMMAD AN-NAFI\'U', classId: '4B' },
            { id: 's_4B_21', name: 'NIZAM AHMAD AL FARIZI', classId: '4B' },
            { id: 's_4B_22', name: 'RAFEL MARSELINO SETIAWAN', classId: '4B' },
            { id: 's_4B_23', name: 'RAHMANIA MAHISA', classId: '4B' },
            { id: 's_4B_24', name: 'RAYYAN ADLI NUGROHO', classId: '4B' },
            { id: 's_4B_25', name: 'SABILLA SEPTIAN FERNANDA', classId: '4B' },
            { id: 's_4B_26', name: 'SHOBIHA QOTHRUN NADA', classId: '4B' },
            { id: 's_4B_27', name: 'YAN ANDRE MAULANA', classId: '4B' },
            // KELAS 5A
            { id: 's_5A_1', name: 'AIDAN SYAM ABRIZAM', classId: '5A' },
            { id: 's_5A_2', name: 'ALZAFRAN IBRAHIM', classId: '5A' },
            { id: 's_5A_3', name: 'AMANDA KAYLA MAHARANI', classId: '5A' },
            { id: 's_5A_4', name: 'ANANDA PUTRI MAHARANI', classId: '5A' },
            { id: 's_5A_5', name: 'ANDIN FELIA MARTHA', classId: '5A' },
            { id: 's_5A_6', name: 'ANINDITA PRISSY MAISA SANTOSO', classId: '5A' },
            { id: 's_5A_7', name: 'ASHADAM DIANDRA FIRDAUS AKBAR', classId: '5A' },
            { id: 's_5A_8', name: 'AXL OKTAVIA JUNAEDI', classId: '5A' },
            { id: 's_5A_9', name: 'BINTANG PRATAMA SETYAWAN', classId: '5A' },
            { id: 's_5A_10', name: 'CHIQUITA SYAKIRA HANANIA BARRETO', classId: '5A' },
            { id: 's_5A_11', name: 'DZAKIYYA TALITA SAKHI', classId: '5A' },
            { id: 's_5A_12', name: 'ERLIA PUTRI CAHYANI', classId: '5A' },
            { id: 's_5A_13', name: 'HAMIZAN AKBAR AL-KHALIFI', classId: '5A' },
            { id: 's_5A_14', name: 'KEYSHA PUTRI RAMADHANI', classId: '5A' },
            { id: 's_5A_15', name: 'KINARA MARITZA RENVIAHUSNA', classId: '5A' },
            { id: 's_5A_16', name: 'LAILA NUR KOMARIAH', classId: '5A' },
            { id: 's_5A_17', name: 'MOCH GIBRAN GIFFARY', classId: '5A' },
            { id: 's_5A_18', name: 'MOCH. WAHYU ALBUSTOMI', classId: '5A' },
            { id: 's_5A_19', name: 'MOCHAMAD MIFTAHUL AZIZ', classId: '5A' },
            { id: 's_5A_20', name: 'MUHAMMAD REFAT ALDRIC RAHADIAN', classId: '5A' },
            { id: 's_5A_21', name: 'MUHAMMAD YASID', classId: '5A' },
            { id: 's_5A_22', name: 'MUKHAMMAD HAMBALI', classId: '5A' },
            { id: 's_5A_23', name: 'NAJWA ALISHA KINANTAKA', classId: '5A' },
            { id: 's_5A_24', name: 'RACHEL AMALIA YUNIAWAN', classId: '5A' },
            { id: 's_5A_25', name: 'RIFQIHANUN JELITA PUTRI PRIADITAMA', classId: '5A' },
            { id: 's_5A_26', name: 'SAFIRA DWI AGUSTIN', classId: '5A' },
            { id: 's_5A_27', name: 'SAKHA DIFAZ HAMZAH NASUTION', classId: '5A' },
            { id: 's_5A_28', name: 'SHERIN D\'ANGELLA PERMANA', classId: '5A' },
            { id: 's_5A_29', name: 'THALITA AZKA FARHANAH', classId: '5A' },
            { id: 's_5A_30', name: 'USWATUN KHASANA', classId: '5A' },
            { id: 's_5A_31', name: 'VIDAN PUTRA RAMADHANA', classId: '5A' },
            { id: 's_5A_32', name: 'ZAFEERA AQILANOER', classId: '5A' },
            // KELAS 5B
            { id: 's_5B_1', name: 'ADZKIA SAMHA NURSAUFA', classId: '5B' },
            { id: 's_5B_2', name: 'AHMAD KHOIRUDIN ', classId: '5B' },
            { id: 's_5B_3', name: 'AINA MARDIYYAH YUSTRIANA', classId: '5B' },
            { id: 's_5B_4', name: 'AKHDAN ACHMAD AZZAMI', classId: '5B' },
            { id: 's_5B_5', name: 'ALDO KURNIA GO', classId: '5B' },
            { id: 's_5B_6', name: 'ALFINO ZAUKI SEPTIANSYAH', classId: '5B' },
            { id: 's_5B_7', name: 'ALIFA ILMI UMAZIDAH', classId: '5B' },
            { id: 's_5B_8', name: 'ALVARO NIZAM ATMAJAYA', classId: '5B' },
            { id: 's_5B_9', name: 'ANIFATUL \'IZZAH', classId: '5B' },
            { id: 's_5B_10', name: 'AQIVA NAILA PUTRI', classId: '5B' },
            { id: 's_5B_11', name: 'ARIQA A\'YUMNA', classId: '5B' },
            { id: 's_5B_12', name: 'ARYASATYA ADYATAMA MADANI', classId: '5B' },
            { id: 's_5B_13', name: 'ATIFFAH GLADYS TAFANA', classId: '5B' },
            { id: 's_5B_14', name: 'AULIA BILQIS SHAFIRA', classId: '5B' },
            { id: 's_5B_15', name: 'BILAL AHZA ISLAMI RASYAA', classId: '5B' },
            { id: 's_5B_16', name: 'CAHYANING TYAS MAHARDIKA', classId: '5B' },
            { id: 's_5B_17', name: 'CHARIR LAGA SASMITA', classId: '5B' },
            { id: 's_5B_18', name: 'DANESH MAULANA PRASTIAN', classId: '5B' },
            { id: 's_5B_19', name: 'FINA AULA FITRIYAH', classId: '5B' },
            { id: 's_5B_20', name: 'GILANG RAMADHAN', classId: '5B' },
            { id: 's_5B_21', name: 'JUZLA EL GHENIYA SHANUM', classId: '5B' },
            { id: 's_5B_22', name: 'KHADIJAH HADIYATUL WAHDAH', classId: '5B' },
            { id: 's_5B_23', name: 'MOCH ZAHVRAN HAIDAR NASHR', classId: '5B' },
            { id: 's_5B_24', name: 'NABILA OKTAVIA ADHA', classId: '5B' },
            { id: 's_5B_25', name: 'NATHASA PUTRI HARIANA', classId: '5B' },
            { id: 's_5B_26', name: 'NAYLA KARLITA RAMDHANI', classId: '5B' },
            { id: 's_5B_27', name: 'RASYA MUHAMMAD ATHAYA SANTOSO', classId: '5B' },
            { id: 's_5B_28', name: 'RISILIYA ARIANI ARIFIN', classId: '5B' },
            { id: 's_5B_29', name: 'SABIO PANJI PURNOMO', classId: '5B' },
            { id: 's_5B_30', name: 'ULFA NOVIATUS SOLIKHAH', classId: '5B' },
            { id: 's_5B_31', name: 'YASMIN MAULIDA', classId: '5B' },
            // KELAS 6A
            { id: 's_6A_1', name: 'ABDHI GUSTI WICAKSONO', classId: '6A' },
            { id: 's_6A_2', name: 'AL MAQVIRA FARZANA PUTRI', classId: '6A' },
            { id: 's_6A_3', name: 'ALYZA NASRIN NAFEEZA', classId: '6A' },
            { id: 's_6A_4', name: 'AMEERA ZAHRA KHAIRUNNISA', classId: '6A' },
            { id: 's_6A_5', name: 'ARJUNA AHMAD AL GHIFFARA', classId: '6A' },
            { id: 's_6A_6', name: 'DEWI MAULIDIYAH', classId: '6A' },
            { id: 's_6A_7', name: 'DHANISA ANDHARA TRI RASTAFARA', classId: '6A' },
            { id: 's_6A_8', name: 'DZAKIRA TALITA ZAHRANI', classId: '6A' },
            { id: 's_6A_9', name: 'ELGA MAULIDDYA WINARSO PUTRI', classId: '6A' },
            { id: 's_6A_10', name: 'ELYSIA WULAN MEI', classId: '6A' },
            { id: 's_6A_11', name: 'GAVAN AVAREL ATHAR RAMADHAN', classId: '6A' },
            { id: 's_6A_12', name: 'HAFIZ MAULANA BACHTIAR', classId: '6A' },
            { id: 's_6A_13', name: 'KHAIRA ERSYA NEIFALANITA', classId: '6A' },
            { id: 's_6A_14', name: 'KINARA ALIFHA SYAQILLA', classId: '6A' },
            { id: 's_6A_15', name: 'LUKLUK NURIA QOLBI', classId: '6A' },
            { id: 's_6A_16', name: 'M. KHOLIDUL ASYHAR', classId: '6A' },
            { id: 's_6A_17', name: 'MARCEL VALENTINO LOINA BASUKI', classId: '6A' },
            { id: 's_6A_18', name: 'MUHAMMAD GIAN ADITYA ARDHANI', classId: '6A' },
            { id: 's_6A_19', name: 'MUHAMMAD HAFIDZ AFFANDI', classId: '6A' },
            { id: 's_6A_20', name: 'SAFIRA QURROTA AYUN', classId: '6A' },
            { id: 's_6A_21', name: 'SYAMSUDIN ACHMAD ALFARIDZI', classId: '6A' },
            { id: 's_6A_22', name: 'SYAQINA AZ ZAHRA PUTRI RAY', classId: '6A' },
            { id: 's_6A_23', name: 'YUDHA DESRENDA PRIDEYASMARA', classId: '6A' },
            { id: 's_6A_24', name: 'YUDHAN DESANDRA PRIDIYASMARA', classId: '6A' },
            { id: 's_6A_25', name: 'ZAHIRIL HAMDI EL MADJID', classId: '6A' },
            { id: 's_6A_26', name: 'ZAVIERA KANZA RAMADHANI', classId: '6A' },
            // KELAS 6B
            { id: 's_6B_1', name: 'ALBERTUS AGUNG PRAYUDA', classId: '6B' },
            { id: 's_6B_2', name: 'ALBY LUTHFY AZZAHIDI', classId: '6B' },
            { id: 's_6B_3', name: 'ALISHA OKTAVIA PUTRIRAVANIA', classId: '6B' },
            { id: 's_6B_4', name: 'BAZLIANTA IZHAR IRNAWANTO', classId: '6B' },
            { id: 's_6B_5', name: 'DAVINDA MAULIDYA', classId: '6B' },
            { id: 's_6B_6', name: 'DAVINO PRADIBTYA WAHYUDI', classId: '6B' },
            { id: 's_6B_7', name: 'ELVIRA NALDA', classId: '6B' },
            { id: 's_6B_8', name: 'FATIMATUS ZAHROH', classId: '6B' },
            { id: 's_6B_9', name: 'HAFFAFA ERLANGGENG ALFADHLI', classId: '6B' },
            { id: 's_6B_10', name: 'HARLAN AINURROZIQIN', classId: '6B' },
            { id: 's_6B_11', name: 'JOVIAN ABEL SUBAKRI', classId: '6B' },
            { id: 's_6B_12', name: 'KEYLA RASHA', classId: '6B' },
            { id: 's_6B_13', name: 'KHANZA AZAHRA PERMATA FAUZY', classId: '6B' },
            { id: 's_6B_14', name: 'MIRZA AHNAF BAIHAQI', classId: '6B' },
            { id: 's_6B_15', name: 'MOCHAMAD KRISNA RAYTANDRA', classId: '6B' },
            { id: 's_6B_16', name: 'MUHAMMAD YUDHISTIRA EL WILDAN', classId: '6B' },
            { id: 's_6B_17', name: 'NORA ALEEZA KUSTIAWAN', classId: '6B' },
            { id: 's_6B_18', name: 'PRAJNA PARAMITA HAYU', classId: '6B' },
            { id: 's_6B_19', name: 'QUINSA KALEA AZZAHRA', classId: '6B' },
            { id: 's_6B_20', name: 'RAHMA AZZAHRA CHUSNA', classId: '6B' },
            { id: 's_6B_21', name: 'RAYHAN FAHRY SEFTIAWAN', classId: '6B' },
            { id: 's_6B_22', name: 'SAYURI KALILA YUDISTIRA', classId: '6B' },
            { id: 's_6B_23', name: 'SOFIA AZ ZAHRA', classId: '6B' },
        ];

        // --- ICONS (SVG STRINGS) ---
        const Icons = {
            Sun: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>,
            Moon: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>,
            Heart: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
            Activity: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>,
            Utensils: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>,
            BookOpen: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            Users: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            CheckCircle: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4 12 14.01l-3-3"/></svg>,
            Calendar: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Trophy: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            Star: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            User: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
            LogOut: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>,
            Award: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
            MessageSquare: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
            Video: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m22 8-6 4 6 4V8Z"/><rect width="14" height="12" x="2" y="6" rx="2" ry="2"/></svg>,
            Music: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>,
            ChevronDown: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m6 9 6 6 6-6"/></svg>,
            ChevronUp: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m18 15-6-6-6 6"/></svg>,
            Close: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
            Refresh: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 21h5v-5"/></svg>
        };

        // --- STICKER & VALIDATION CONSTANTS ---
        const VALIDATION_OPTIONS = [
            { label: "Sangat Baik", value: "sangat_baik", color: "bg-green-100 text-green-700 border-green-300", icon: "ðŸŒŸ", desc: "Luar Biasa!" },
            { label: "Baik", value: "baik", color: "bg-blue-100 text-blue-700 border-blue-300", icon: "ðŸ‘", desc: "Pertahankan!" },
            { label: "Cukup", value: "cukup", color: "bg-yellow-100 text-yellow-700 border-yellow-300", icon: "ðŸ™‚", desc: "Tingkatkan lagi." },
            { label: "Kurang", value: "kurang", color: "bg-red-100 text-red-700 border-red-300", icon: "ðŸ’ª", desc: "Ayo semangat!" }
        ];

        const HABITS = [
          { 
            id: 'h1', title: 'Bangun Pagi', icon: Icons.Sun, color: 'text-yellow-500', desc: 'Target: 04.00 - 05.00', type: 'time',
            items: ['Bangun tidur antara pukul 04.00 - 05.00.', 'Merapikan tempat tidur sendiri.']
          },
          { 
            id: 'h2', title: 'Beribadah', icon: Icons.Heart, color: 'text-purple-500', desc: 'Sholat/Ibadah & Doa', type: 'check',
            items: ['Melaksanakan ibadah sholat 5 waktu.', 'Berdoa sebelum belajar.', 'Membaca kitab suci/mengaji.']
          },
          { 
            id: 'h3', title: 'Membantu Ortu', icon: Icons.Activity, color: 'text-red-500', desc: 'Bakti Orang Tua', type: 'check',
            items: ['Membantu pekerjaan rumah ringan.', 'Berpamitan sebelum berangkat sekolah.', 'Menyapa orang tua dengan sopan.']
          },
          { 
            id: 'h4', title: 'Makan Sehat', icon: Icons.Utensils, color: 'text-green-500', desc: 'Gizi & Sarapan', type: 'check',
            items: ['Sarapan sebelum berangkat sekolah.', 'Membawa bekal sehat.', 'Minum air putih cukup.', 'Tidak jajan sembarangan.']
          },
          { 
            id: 'h5', title: 'Belajar', icon: Icons.BookOpen, color: 'text-blue-500', desc: 'Belajar Mandiri', type: 'check',
            items: ['Mengulang pelajaran sekolah.', 'Mengerjakan PR.', 'Membaca buku cerita/pengetahuan.']
          },
          { 
            id: 'h6', title: 'Kebersihan', icon: Icons.CheckCircle, color: 'text-teal-500', desc: 'Diri & Lingkungan', type: 'check',
            items: ['Mandi 2x sehari.', 'Sikat gigi sesudah makan/sebelum tidur.', 'Membuang sampah pada tempatnya.']
          },
          { 
            id: 'h7', title: 'Tidur Malam', icon: Icons.Moon, color: 'text-indigo-600', desc: 'Maksimal 21:00', type: 'time',
            items: ['Tidur tidak larut malam (maks jam 9).', 'Berdoa sebelum tidur.']
          },
        ];

        // --- COMPONENTS ---

        const Card = ({ children, className = '' }) => (
            <div className={`bg-white rounded-xl shadow-sm border border-slate-100 ${className}`}>
                {children}
            </div>
        );

        const TimePicker24H = ({ value, onChange, disabled }) => {
            const [hours, minutes] = (value || "00:00").split(":");

            const handleHourChange = (e) => {
                const newH = e.target.value;
                onChange(`${newH}:${minutes}`);
            };

            const handleMinuteChange = (e) => {
                const newM = e.target.value;
                onChange(`${hours}:${newM}`);
            };

            const hourOptions = Array.from({ length: 24 }, (_, i) => i.toString().padStart(2, '0'));
            const minuteOptions = Array.from({ length: 60 }, (_, i) => i.toString().padStart(2, '0'));

            return (
                <div className="flex items-center gap-1 bg-white border-2 border-blue-100 rounded-lg p-1 shadow-sm">
                    <select 
                        value={hours} 
                        onChange={handleHourChange}
                        disabled={disabled}
                        className="bg-transparent text-sm font-bold text-blue-600 outline-none p-1 cursor-pointer appearance-none text-center min-w-[40px]"
                    >
                        {hourOptions.map(h => <option key={h} value={h}>{h}</option>)}
                    </select>
                    <span className="text-blue-300 font-bold">:</span>
                    <select 
                        value={minutes} 
                        onChange={handleMinuteChange}
                        disabled={disabled}
                        className="bg-transparent text-sm font-bold text-blue-600 outline-none p-1 cursor-pointer appearance-none text-center min-w-[40px]"
                    >
                        {minuteOptions.map(m => <option key={m} value={m}>{m}</option>)}
                    </select>
                </div>
            );
        };

        // Setup Instruction Screen
        function SetupInstruction() {
            return (
                <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4">
                    <Card className="w-full p-8 text-center animate-fade-in-up">
                        <div className="w-20 h-20 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-6">
                            <Icons.Sun />
                        </div>
                        <h1 className="text-2xl font-bold text-slate-800 mb-2">Konfigurasi Diperlukan</h1>
                        <p className="text-slate-600 mb-6">
                            Aplikasi belum terhubung ke database. Silakan atur konfigurasi Firebase di dalam kode (bagian <code>firebaseConfig</code>).
                        </p>
                    </Card>
                </div>
            );
        }

        function HabitList({ initialData, onSave, isReadOnly }) {
            const [data, setData] = React.useState({});
            const [expandedHabit, setExpandedHabit] = React.useState(null);
            const [showConfirm, setShowConfirm] = React.useState(false);

            React.useEffect(() => {
                const defaults = {};
                HABITS.forEach(h => {
                    defaults[h.id] = initialData[h.id] || { status: false, timeValue: '' };
                });
                setData(defaults);
            }, [initialData]);

            const toggleExpand = (id) => {
                setExpandedHabit(expandedHabit === id ? null : id);
            };

            const handleChange = (id, field, value) => {
                if (isReadOnly) return;
                
                const newData = {
                    ...data,
                    [id]: { ...data[id], [field]: value }
                };

                // Logic Bangun Pagi
                if (id === 'h1' && field === 'timeValue') { 
                    const [hours, mins] = value.split(':').map(Number);
                    const timeVal = hours + (mins/60);
                    // Bangun ideal 04:00 - 05:00
                    newData[id].status = timeVal >= 4 && timeVal <= 5.5;
                }
                
                // Logic Tidur
                if (id === 'h7' && field === 'timeValue') { 
                    const [hours, mins] = value.split(':').map(Number);
                    // Tidur ideal sebelum jam 21:00
                    // Kita anggap jam 18:00 - 21:00 adalah waktu tidur anak SD yang baik
                    const timeVal = hours + (mins/60);
                    newData[id].status = (timeVal >= 18 && timeVal <= 21); 
                }

                setData(newData);
            };

            const triggerConfirm = () => {
                setShowConfirm(true);
            }

            const confirmSave = () => {
                setShowConfirm(false);
                onSave({
                    ...data
                });
            };

            return (
                <div className="space-y-4">
                    {HABITS.map(habit => {
                        const itemData = data[habit.id] || { status: false, timeValue: '' };
                        const Icon = habit.icon;
                        const isExpanded = expandedHabit === habit.id;
                        
                        return (
                            <Card key={habit.id} className="p-4 transition-all hover:shadow-md">
                                <div className="flex flex-col sm:flex-row sm:items-center gap-4">
                                    <div className={`p-3 rounded-xl bg-slate-50 ${habit.color}`}>
                                        <Icon />
                                    </div>
                                    <div className="flex-1 cursor-pointer" onClick={() => toggleExpand(habit.id)}>
                                        <h3 className="font-bold text-slate-800 flex items-center gap-2">
                                            {habit.title}
                                            {isExpanded ? <Icons.ChevronUp /> : <Icons.ChevronDown />}
                                        </h3>
                                        <p className="text-xs text-slate-500">{habit.desc}</p>
                                    </div>
                                    
                                    <div className="flex items-center gap-4">
                                        {habit.type === 'time' && (
                                            <div className="flex flex-col items-end gap-1">
                                                <TimePicker24H 
                                                    value={itemData.timeValue}
                                                    onChange={(val) => handleChange(habit.id, 'timeValue', val)}
                                                    disabled={isReadOnly}
                                                />
                                            </div>
                                        )}
                                        
                                        <button
                                            disabled={isReadOnly || habit.type === 'time'}
                                            onClick={() => handleChange(habit.id, 'status', !itemData.status)}
                                            className={`w-12 h-12 rounded-full flex items-center justify-center transition-all ${
                                                itemData.status 
                                                ? 'bg-green-500 text-white shadow-green-200 shadow-lg scale-105' 
                                                : 'bg-slate-100 text-slate-300 hover:bg-slate-200'
                                            }`}
                                        >
                                            {itemData.status ? <Icons.CheckCircle /> : <div className="w-4 h-4 rounded-full border-2 border-slate-300" />}
                                        </button>
                                    </div>
                                </div>

                                {isExpanded && (
                                    <div className="mt-4 pt-3 border-t border-slate-100 bg-slate-50/50 -mx-4 -mb-4 p-4 rounded-b-xl animate-fade-in-down">
                                        <p className="text-xs font-bold text-slate-500 uppercase mb-2">Kegiatan:</p>
                                        <ul className="space-y-1">
                                            {habit.items.map((item, idx) => (
                                                <li key={idx} className="text-sm text-slate-600 flex items-start gap-2">
                                                    <div className="w-1.5 h-1.5 rounded-full bg-blue-400 mt-1.5 shrink-0" />
                                                    <span>{item}</span>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>
                                )}
                            </Card>
                        );
                    })}
                    
                    {!isReadOnly && (
                        <div className="sticky bottom-4">
                            <button 
                                onClick={triggerConfirm}
                                className="w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-200 active:scale-95 transition-all flex justify-center items-center gap-2"
                            >
                               <Icons.CheckCircle size={20}/> Simpan Jurnal
                            </button>
                        </div>
                    )}

                    {showConfirm && (
                        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-[100] p-4 animate-fade-in-up">
                            <div className="bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl text-center">
                                <div className="w-16 h-16 bg-yellow-100 text-yellow-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <span className="text-3xl">âš ï¸</span>
                                </div>
                                <h3 className="font-bold text-lg text-slate-800 mb-2">Simpan Data?</h3>
                                <p className="text-sm text-slate-500 mb-6">
                                    Pastikan data sudah benar. Jurnal hanya bisa diisi 1 kali sehari.
                                </p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowConfirm(false)} className="flex-1 py-2 text-slate-600 font-medium hover:bg-slate-100 rounded-lg transition-colors">Cek Lagi</button>
                                    <button onClick={confirmSave} className="flex-1 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors shadow-md">Ya, Simpan</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function LoginScreen({ onLogin }) {
            const [role, setRole] = React.useState('student');
            
            // --- FILTER KELAS 1-6 ---
            const [selectedGrade, setSelectedGrade] = React.useState('1'); 
            const [selectedSubClass, setSelectedSubClass] = React.useState('1A');

            // Guru Login
            const [username, setUsername] = React.useState('');
            const [password, setPassword] = React.useState('');
            const [loginError, setLoginError] = React.useState(''); 

            // Logic Sub-Class (1A, 1B, 1C, dst)
            const availableSubClasses = React.useMemo(() => {
                const classes = new Set(
                    ALL_STUDENTS
                    .filter(s => s.classId.startsWith(selectedGrade))
                    .map(s => s.classId)
                );
                return Array.from(classes).sort();
            }, [selectedGrade]);

            React.useEffect(() => {
                if (availableSubClasses.length > 0) {
                    setSelectedSubClass(availableSubClasses[0]);
                }
            }, [selectedGrade, availableSubClasses]);
            
            const filteredStudents = React.useMemo(() => {
                return ALL_STUDENTS.filter(s => s.classId === selectedSubClass);
            }, [selectedSubClass]);

            const handleLogin = (id, name, role, classId) => {
                let childId = null;
                if (role === 'parent') {
                    childId = id.replace('parent_', ''); 
                }
                onLogin({ id, name, role, classId, childId });
            };

            const handleTeacherLogin = () => {
                const teacher = TEACHERS.find(t => t.username === username && t.password === password);
                if (teacher) {
                    setLoginError('');
                    onLogin({ id: teacher.id, name: teacher.name, role: 'teacher', classId: teacher.classId });
                } else {
                    setLoginError("Username atau Password salah.");
                }
            };

            return (
                <div className="h-full min-h-screen bg-gradient-to-br from-blue-500 to-indigo-600 flex flex-col items-center justify-center p-4">
                    <Card className="w-full p-6 animate-fade-in-up shadow-xl">
                        <div className="text-center mb-8">
                            <div className="flex justify-center items-center gap-4 mb-4">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Logo_of_Ministry_of_Education_and_Culture_of_Republic_of_Indonesia.svg/480px-Logo_of_Ministry_of_Education_and_Culture_of_Republic_of_Indonesia.svg.png" alt="Tutwuri" className="w-16 h-16 object-contain"/>
                                <img src="https://drive.google.com/thumbnail?id=1WIjh5VSlSez_PVmbX5w23YS0ikEhHeQ9&sz=w200" alt="Logo Sekolah" className="w-16 h-16 object-contain"/>
                            </div>
                            <h1 className="text-3xl font-extrabold text-blue-700 tracking-tight drop-shadow-sm">Jurnal KAIH</h1>
                            <p className="text-slate-500 text-sm font-semibold mt-1">Kebiasaan Anak Indonesia Hebat</p>
                            <h2 className="text-xl font-bold text-orange-600 mt-2 mb-2 drop-shadow-sm">SD Negeri 3 Turen</h2>
                        </div>

                        <div className="flex bg-slate-100 p-1 rounded-lg mb-6">
                            {['student', 'parent', 'teacher'].map(r => (
                                <button
                                    key={r}
                                    onClick={() => setRole(r)}
                                    className={`flex-1 py-2 text-sm font-medium rounded-md transition-all ${
                                        role === r ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'
                                    }`}
                                >
                                    {r === 'student' ? 'Murid' : r === 'parent' ? 'Ortu' : 'Guru'}
                                </button>
                            ))}
                        </div>

                        <div className="space-y-4">
                            {role === 'teacher' ? (
                                <div className="space-y-3">
                                    <div>
                                        <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1">Username</label>
                                        <input type="text" value={username} onChange={(e) => setUsername(e.target.value)} className="w-full border rounded-lg p-2 text-sm outline-none focus:border-blue-500" placeholder="Username"/>
                                    </div>
                                    <div>
                                        <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1">Password</label>
                                        <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} className="w-full border rounded-lg p-2 text-sm outline-none focus:border-blue-500" placeholder="Password"/>
                                    </div>
                                    {loginError && <div className="text-red-500 text-xs text-center">{loginError}</div>}
                                    <button onClick={handleTeacherLogin} className="w-full bg-blue-600 text-white font-bold py-3 rounded-xl shadow-lg active:scale-95 transition-all mt-2">Masuk Guru</button>
                                </div>
                            ) : (
                                <>
                                    {/* PILIH KELAS 1-6 */}
                                    <div>
                                        <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Tingkat Kelas</label>
                                        <div className="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
                                            {['1', '2', '3', '4', '5', '6'].map(c => (
                                                <button
                                                    key={c}
                                                    onClick={() => setSelectedGrade(c)}
                                                    className={`flex-1 min-w-[50px] px-3 py-2 rounded-lg text-sm font-medium border transition-all ${
                                                        selectedGrade === c 
                                                        ? 'bg-blue-600 text-white border-blue-600 shadow-md' 
                                                        : 'bg-white text-slate-600 border-slate-200'
                                                    }`}
                                                >
                                                    {c}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {availableSubClasses.length > 0 && (
                                        <div className="animate-fade-in-up">
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Sub Kelas</label>
                                            <div className="relative">
                                                <select 
                                                    value={selectedSubClass}
                                                    onChange={(e) => setSelectedSubClass(e.target.value)}
                                                    className="w-full bg-white border border-slate-300 text-slate-700 py-3 px-4 rounded-xl focus:outline-none focus:border-blue-500 font-medium appearance-none"
                                                >
                                                    {availableSubClasses.map(cls => (
                                                        <option key={cls} value={cls}>Kelas {cls}</option>
                                                    ))}
                                                </select>
                                                <div className="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-slate-500">â–¼</div>
                                            </div>
                                        </div>
                                    )}

                                    <div className="pt-2">
                                        <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">
                                            {role === 'student' ? 'Nama Siswa' : 'Nama Anak'} 
                                            <span className="text-slate-400 font-normal ml-1">({filteredStudents.length})</span>
                                        </label>
                                        <div className="max-h-60 overflow-y-auto space-y-2 border rounded-xl p-2 bg-slate-50 student-list">
                                            {filteredStudents.length > 0 ? (
                                                filteredStudents.map(s => (
                                                    <button
                                                        key={s.id}
                                                        onClick={() => handleLogin(role === 'student' ? s.id : `parent_${s.id}`, role === 'student' ? s.name : `Ortu ${s.name}`, role, s.classId)}
                                                        className="w-full flex items-center p-3 bg-white border rounded-lg hover:border-blue-500 hover:shadow-sm transition-all text-left group"
                                                    >
                                                        <div className="w-8 h-8 rounded-full bg-slate-100 group-hover:bg-blue-50 flex items-center justify-center mr-3 text-xs font-bold text-slate-500 group-hover:text-blue-600 transition-colors">
                                                            {s.name.substring(0, 1)}
                                                        </div>
                                                        <div className="flex-1">
                                                            <span className="block text-sm font-medium text-slate-700 group-hover:text-blue-700">{s.name}</span>
                                                            <span className="block text-[10px] text-slate-400">{s.classId}</span>
                                                        </div>
                                                    </button>
                                                ))
                                            ) : (
                                                <div className="text-center py-8 text-slate-400 text-sm">Tidak ada data siswa</div>
                                            )}
                                        </div>
                                    </div>
                                </>
                            )}
                        </div>
                    </Card>
                </div>
            );
        }

        function App() {
            if (!isConfigValid) return <SetupInstruction />;

            const [user, setUser] = React.useState(null);
            const [appUser, setAppUser] = React.useState(null);
            const [loading, setLoading] = React.useState(true);

            React.useEffect(() => {
                const initAuth = async () => {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        try { await auth.signInWithCustomToken(__initial_auth_token); } 
                        catch (e) { await auth.signInAnonymously(); }
                    } else {
                        await auth.signInAnonymously();
                    }
                };
                initAuth();
                const unsubscribe = auth.onAuthStateChanged((u) => {
                    setUser(u);
                    setLoading(false);
                });
                return () => unsubscribe();
            }, []);

            if (loading) return <div className="h-screen flex items-center justify-center bg-slate-100 text-slate-500">Memuat...</div>;
            if (!appUser) return <LoginScreen onLogin={setAppUser} />;

            return (
                <div className="min-h-screen font-sans text-slate-800 pb-20 bg-slate-50">
                    <header className="bg-white border-b sticky top-0 z-50">
                        <div className="w-full px-4 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <h1 className="font-bold text-sm text-blue-600">Jurnal KAIH</h1>
                            </div>
                            <div className="flex items-center gap-3">
                                <span className="text-xs font-semibold text-slate-500 text-right">{appUser.name}<br/>{appUser.role === 'teacher' ? 'Guru' : appUser.classId}</span>
                                <button onClick={() => setAppUser(null)} className="p-2 text-red-500 bg-red-50 rounded-lg"><Icons.LogOut/></button>
                            </div>
                        </div>
                    </header>
                    <main className="w-full p-4">
                        {appUser.role === 'student' && <StudentDashboard user={appUser} firebaseUser={user} />}
                        {appUser.role === 'teacher' && <TeacherDashboard user={appUser} firebaseUser={user} />}
                        {appUser.role === 'parent' && <ParentDashboard user={appUser} firebaseUser={user} />}
                    </main>
                </div>
            );
        }

        // --- DASHBOARDS ---

        function ParentDashboard({ user, firebaseUser }) {
             const [date, setDate] = React.useState(new Date().toISOString().split('T')[0]);
             const [childLog, setChildLog] = React.useState(null);
             
             React.useEffect(() => {
                if (!firebaseUser || !user.childId) return;
                const docRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection(`logs_${user.childId}`).doc(date);
                docRef.onSnapshot(doc => {
                    setChildLog(doc.exists ? doc.data() : null);
                });
             }, [firebaseUser, user.childId, date]);

             const handleSaveValidation = async (rating) => {
                 if (!user.childId) return;
                 if (childLog && childLog.parentValidation) {
                     alert("Sudah divalidasi hari ini.");
                     return;
                 }
                 const stickerInfo = VALIDATION_OPTIONS.find(v => v.value === rating);
                 const dataToUpdate = {
                     parentValidation: {
                         rating: rating,
                         sticker: stickerInfo.icon,
                         timestamp: new Date().toISOString(),
                         parentName: user.name
                     }
                 };
                 await db.collection('artifacts').doc(appId).collection('public').doc('data').collection(`logs_${user.childId}`).doc(date).set(dataToUpdate, { merge: true });
                 alert("Validasi terkirim!");
             };

             return (
                <div className="space-y-6">
                  <div className="bg-purple-600 rounded-2xl p-6 text-white shadow-lg">
                    <h2 className="text-xl font-bold">Portal Orang Tua</h2>
                    <p className="text-purple-100 text-sm">Memantau: {user.name.replace('Ortu ', '')}</p>
                  </div>
                  <div className="flex items-center justify-between bg-white p-3 rounded-xl shadow-sm border">
                        <div className="flex items-center gap-2">
                            <Icons.Calendar className="text-slate-500"/>
                            <span className="text-sm font-semibold text-slate-600">Tanggal:</span>
                        </div>
                        <input type="date" value={date} onChange={(e) => setDate(e.target.value)} className="outline-none font-medium text-slate-700"/>
                  </div>

                  {!childLog ? (
                      <div className="text-center py-12 bg-white rounded-xl border border-dashed border-slate-300">
                          <p className="text-slate-500 font-medium">Belum ada jurnal</p>
                          <p className="text-xs text-slate-400">Anak belum mengisi jurnal hari ini.</p>
                      </div>
                  ) : (
                      <>
                          <Card className="p-4 bg-white">
                              <h3 className="font-bold text-lg text-slate-800 mb-4 border-b pb-2">Isian Jurnal</h3>
                              <HabitList initialData={childLog} isReadOnly={true} />
                          </Card>
                          <Card className="p-4 border-t-4 border-purple-500 bg-white">
                              <h3 className="font-bold text-slate-800 text-center mb-2">Validasi Orang Tua</h3>
                              {childLog.parentValidation ? (
                                  <div className="text-center p-4 bg-purple-50 rounded-xl border border-purple-100">
                                      <div className="text-4xl mb-2">{childLog.parentValidation.sticker}</div>
                                      <p className="text-purple-800 font-bold">Sudah Divalidasi</p>
                                  </div>
                              ) : (
                                  <div className="grid grid-cols-2 gap-3">
                                      {VALIDATION_OPTIONS.map((opt) => (
                                          <button key={opt.value} onClick={() => handleSaveValidation(opt.value)} className="p-3 rounded-xl border-2 flex flex-col items-center gap-1 hover:bg-purple-50">
                                              <span className="text-2xl">{opt.icon}</span>
                                              <span className="text-xs font-bold text-slate-700">{opt.label}</span>
                                          </button>
                                      ))}
                                  </div>
                              )}
                          </Card>
                      </>
                  )}
                </div>
             );
        }

        function StudentDashboard({ user, firebaseUser }) {
             const [date, setDate] = React.useState(new Date().toISOString().split('T')[0]);
             const [logData, setLogData] = React.useState({});
             const [isSaving, setIsSaving] = React.useState(false);
             const [isAlreadyFilled, setIsAlreadyFilled] = React.useState(false);

             React.useEffect(() => {
                if (!firebaseUser) return;
                const docRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection(`logs_${user.id}`);
                docRef.onSnapshot(snapshot => {
                      const logs = {};
                      snapshot.forEach(doc => logs[doc.id] = doc.data());
                      setLogData(logs);
                      setIsAlreadyFilled(!!logs[date]);
                    },
                    error => { console.error("Firestore Error:", error); alert("Gagal memuat data. Cek koneksi."); }
                );
             }, [firebaseUser, date]);

             const handleSave = async (habitData) => {
                 setIsSaving(true);
                 let points = 0;
                 Object.keys(habitData).forEach(k => { if(habitData[k] && habitData[k].status) points++; });
                 const percentage = Math.round((points/7)*100); // 7 Habit items

                 const dataToSave = {
                     role: 'student',
                     ...habitData, 
                     date, 
                     studentId: user.id, 
                     studentName: user.name, 
                     classId: user.classId, 
                     completionPercentage: percentage
                 };

                 try {
                     await db.collection('artifacts').doc(appId).collection('public').doc('data').collection(`logs_${user.id}`).doc(date).set(dataToSave, { merge: true });
                     
                     // Kirim ke Google Sheet jika dikonfigurasi
                     if (GOOGLE_SHEET_SCRIPT_URL) {
                         await fetch(GOOGLE_SHEET_SCRIPT_URL, {
                             method: 'POST', mode: 'no-cors',
                             headers: { 'Content-Type': 'application/json' },
                             body: JSON.stringify(dataToSave)
                         });
                     }
                     alert("Jurnal Berhasil Disimpan!");
                 } catch (error) {
                     alert("Gagal menyimpan: " + error.message);
                 } finally {
                     setIsSaving(false);
                 }
             };

             return (
                 <div className="space-y-6">
                    <div className="bg-blue-600 rounded-2xl p-6 text-white shadow-lg">
                        <h2 className="text-2xl font-bold">Halo, {user.name}!</h2>
                        <p className="text-blue-100 text-sm">Ayo isi jurnal hari ini.</p>
                    </div>
                    <div className="flex items-center justify-between bg-white p-3 rounded-xl shadow-sm border">
                        <Icons.Calendar className="text-slate-500"/>
                        <input type="date" value={date} onChange={(e) => setDate(e.target.value)} className="outline-none"/>
                    </div>
                    
                    {isAlreadyFilled && (
                        <div className="bg-green-100 border border-green-200 text-green-800 p-4 rounded-xl text-center font-bold">
                            âœ… Jurnal hari ini sudah terisi.
                        </div>
                    )}

                    <HabitList 
                        initialData={logData[date] || {}} 
                        onSave={handleSave} 
                        isReadOnly={isAlreadyFilled}
                    />
                    
                    {isSaving && <p className="text-center text-xs text-blue-600 animate-pulse">Menyimpan...</p>}
                 </div>
             )
        }

        function TeacherDashboard({ user, firebaseUser }) {
             const [date, setDate] = React.useState(new Date().toISOString().split('T')[0]);
             const [classLogs, setClassLogs] = React.useState([]);
             const [selectedStudent, setSelectedStudent] = React.useState(null);
             const [isLoading, setIsLoading] = React.useState(false);
             
             // Guru hanya melihat siswa yang kelasnya DIAWALI dengan kelas wali mereka
             // Jika Guru 1A -> Lihat siswa 1A
             // Jika Guru 1 -> Lihat siswa 1A, 1B, 1C (jika ada logic seperti itu, tapi di sini spesifik)
             const myStudents = React.useMemo(() => {
                 return ALL_STUDENTS.filter(s => s.classId === user.classId);
             }, [user.classId]);
             
             const fetchLogs = React.useCallback(async () => {
                if (!firebaseUser) return;
                setIsLoading(true);
                const logs = [];
                for (const student of myStudents) {
                    const docRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection(`logs_${student.id}`).doc(date);
                    try {
                        const doc = await docRef.get();
                        if (doc.exists) {
                            logs.push({ ...doc.data(), studentName: student.name, studentId: student.id });
                        } else {
                            logs.push({ studentName: student.name, studentId: student.id, notFilled: true });
                        }
                    } catch (e) { console.error(e); }
                }
                setClassLogs(logs);
                setIsLoading(false);
             }, [firebaseUser, myStudents, date]);

             React.useEffect(() => { fetchLogs(); }, [fetchLogs]);

             const handleSaveValidation = async (rating) => {
                 if (!selectedStudent) return;
                 const stickerInfo = VALIDATION_OPTIONS.find(v => v.value === rating);
                 const dataToUpdate = {
                     teacherValidation: {
                         rating: rating,
                         sticker: stickerInfo.icon,
                         timestamp: new Date().toISOString(),
                         teacherName: user.name
                     }
                 };
                 await db.collection('artifacts').doc(appId).collection('public').doc('data').collection(`logs_${selectedStudent.studentId}`).doc(date).set(dataToUpdate, { merge: true });
                 setClassLogs(prev => prev.map(log => 
                    log.studentId === selectedStudent.studentId 
                    ? { ...log, teacherValidation: { rating: rating, sticker: stickerInfo.icon } }
                    : log
                 ));
                 setSelectedStudent(null);
                 alert("Validasi tersimpan.");
             };

             return (
                <div className="space-y-6">
                  <div className="bg-slate-800 rounded-2xl p-6 text-white shadow-lg">
                    <h2 className="text-xl font-bold">Wali Kelas {user.classId}</h2>
                    <p className="text-slate-300 text-sm font-medium mt-1">{user.name}</p>
                  </div>

                  <div className="flex items-center justify-between bg-white p-3 rounded-xl shadow-sm border">
                        <div className="flex items-center gap-2">
                            <Icons.Calendar className="text-slate-500"/>
                            <span className="text-sm font-semibold text-slate-600">Tanggal:</span>
                        </div>
                        <input type="date" value={date} onChange={(e) => setDate(e.target.value)} className="outline-none font-medium text-slate-700"/>
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <Card className="p-4 text-center">
                        <h3 className="text-xs font-bold text-slate-500 uppercase">Siswa</h3>
                        <p className="text-2xl font-bold">{myStudents.length}</p>
                    </Card>
                    <Card className="p-4 text-center">
                        <h3 className="text-xs font-bold text-slate-500 uppercase">Mengisi</h3>
                        <p className="text-2xl font-bold text-green-600">{classLogs.filter(l => !l.notFilled).length}</p>
                    </Card>
                  </div>

                  <Card className="overflow-hidden">
                    <div className="bg-slate-100 px-4 py-3 border-b flex justify-between items-center">
                        <h3 className="font-bold text-slate-700">Daftar Siswa</h3>
                        <button onClick={fetchLogs} disabled={isLoading} className="text-blue-600"><Icons.Refresh/></button>
                    </div>
                    <div className="divide-y divide-slate-100">
                        {classLogs.map((log, idx) => (
                            <div key={idx} onClick={() => !log.notFilled && setSelectedStudent(log)} className={`p-4 flex items-center justify-between ${!log.notFilled ? 'cursor-pointer hover:bg-blue-50' : 'opacity-50'}`}>
                                <div>
                                    <p className="font-medium text-slate-800">{log.studentName}</p>
                                    {!log.notFilled ? (
                                        <div className="flex gap-2 mt-1">
                                            {log.teacherValidation && <span className="text-[10px] px-1.5 rounded bg-blue-100 text-blue-700">{log.teacherValidation.sticker}</span>}
                                        </div>
                                    ) : <span className="text-xs text-red-400 italic">Belum mengisi</span>}
                                </div>
                            </div>
                        ))}
                    </div>
                  </Card>

                  {selectedStudent && (
                      <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-[100] p-4">
                          <div className="bg-white w-full max-w-lg rounded-2xl max-h-[90vh] flex flex-col shadow-2xl">
                              <div className="p-4 border-b flex justify-between items-center bg-slate-50 rounded-t-2xl">
                                  <h3 className="font-bold">{selectedStudent.studentName}</h3>
                                  <button onClick={() => setSelectedStudent(null)}><Icons.Close/></button>
                              </div>
                              <div className="p-4 overflow-y-auto flex-1">
                                  <HabitList initialData={selectedStudent} isReadOnly={true} />
                              </div>
                              <div className="p-4 border-t bg-slate-50 rounded-b-2xl grid grid-cols-2 gap-3">
                                  {VALIDATION_OPTIONS.map((opt) => (
                                      <button key={opt.value} onClick={() => handleSaveValidation(opt.value)} className={`p-2 rounded border flex flex-col items-center ${selectedStudent.teacherValidation?.rating === opt.value ? 'bg-blue-100 border-blue-500' : 'bg-white'}`}>
                                          <span className="text-xl">{opt.icon}</span>
                                          <span className="text-xs font-bold">{opt.label}</span>
                                      </button>
                                  ))}
                              </div>
                          </div>
                      </div>
                  )}
                </div>
             );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
